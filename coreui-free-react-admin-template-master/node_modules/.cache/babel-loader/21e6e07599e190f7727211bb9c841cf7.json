{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"/Users/jasper/Documents/Documents/Zorgtechnologie/Programming/Demonstrator/NDC-Demonstrator/coreui-free-react-admin-template-master/node_modules/@babel/runtime/regenerator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.testRenderer = exports.render = undefined;\n\nvar renderToFile = function () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(element, filePath) {\n    var container, node, output, stream;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            container = (0, _createElement.createElement)('ROOT');\n            (0, _renderUtils.validateElement)(element);\n            (0, _renderUtils.validatePath)(filePath);\n            node = _renderer.WordRenderer.createContainer(container);\n\n            _renderer.WordRenderer.updateContainer(element, node, null);\n\n            _context.next = 7;\n            return (0, _parse2.default)(container).toBuffer();\n\n          case 7:\n            output = _context.sent;\n            stream = _fs2.default.createWriteStream(filePath);\n            _context.next = 11;\n            return new Promise(function (resolve, reject) {\n              output.doc.generate(stream, (0, _renderUtils.Events)(filePath, resolve, reject));\n              (0, _renderUtils.openDocApp)(filePath);\n            });\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function renderToFile(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar renderToMemory = function () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(element) {\n    var container, node, output, stream;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            container = (0, _createElement.createElement)('ROOT');\n            (0, _renderUtils.validateElement)(element);\n            node = _renderer.WordRenderer.createContainer(container);\n\n            _renderer.WordRenderer.updateContainer(element, node, null);\n\n            _context2.next = 6;\n            return (0, _parse2.default)(container).toBuffer();\n\n          case 6:\n            output = _context2.sent;\n            stream = new _memoryStreams2.default.WritableStream();\n            _context2.next = 10;\n            return new Promise(function (resolve, reject) {\n              output.doc.generate(stream);\n              stream.on('finish', function () {\n                resolve();\n              });\n              stream.on('error', function () {\n                reject();\n              });\n            });\n\n          case 10:\n            return _context2.abrupt(\"return\", stream);\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, this);\n  }));\n\n  return function renderToMemory(_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n/**\n * This function renders the component\n * @param {Object} element\n * @param {string} filePath\n */\n\n\nvar render = function () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(element, filePath) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(typeof filePath !== 'undefined')) {\n              _context3.next = 2;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", renderToFile(element, filePath));\n\n          case 2:\n            return _context3.abrupt(\"return\", renderToMemory(element));\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, this);\n  }));\n\n  return function render(_x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n/**\n * Required for test the components\n */\n\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _memoryStreams = require('memory-streams');\n\nvar _memoryStreams2 = _interopRequireDefault(_memoryStreams);\n\nvar _createElement = require('../utils/createElement');\n\nvar _renderer = require('./renderer');\n\nvar _parse = require('./parse');\n\nvar _parse2 = _interopRequireDefault(_parse);\n\nvar _renderUtils = require('../utils/renderUtils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var gen = fn.apply(this, arguments);\n    return new Promise(function (resolve, reject) {\n      function step(key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          return Promise.resolve(value).then(function (value) {\n            step(\"next\", value);\n          }, function (err) {\n            step(\"throw\", err);\n          });\n        }\n      }\n\n      return step(\"next\");\n    });\n  };\n}\n\nfunction testRenderer(element) {\n  var container = (0, _createElement.createElement)('ROOT');\n\n  var node = _renderer.WordRenderer.createContainer(container);\n\n  _renderer.WordRenderer.updateContainer(element, node, null);\n\n  return container;\n}\n\nexports.render = render;\nexports.testRenderer = testRenderer;","map":null,"metadata":{},"sourceType":"script"}