{"ast":null,"code":"// Generated by CoffeeScript 1.10.0\n\n/*\n MS Excel 2007 Creater v0.0.1\n Author : chuanyi.zheng@gmail.com\n History: 2012/11/07 first created\n */\n(function () {\n  var ContentTypes,\n      DocPropsApp,\n      JSZip,\n      SharedStrings,\n      Sheet,\n      Style,\n      Workbook,\n      XlRels,\n      XlWorkbook,\n      baseXl,\n      opt,\n      tool,\n      xml,\n      bind = function bind(fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  };\n\n  JSZip = require('jszip');\n  xml = require('xmlbuilder');\n  tool = {\n    i2a: function i2a(i) {\n      return 'ABCDEFGHIJKLMNOPQRSTUVWXYZ123'.charAt(i - 1);\n    }\n  };\n  opt = {\n    tmpl_path: __dirname\n  };\n\n  ContentTypes = function () {\n    function ContentTypes(book) {\n      this.book = book;\n    }\n\n    ContentTypes.prototype.toxml = function () {\n      var i, l, ref, types;\n      types = xml.create('Types', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      types.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/content-types');\n      types.ele('Override', {\n        PartName: '/xl/theme/theme1.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml'\n      });\n      types.ele('Override', {\n        PartName: '/xl/styles.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'\n      });\n      types.ele('Default', {\n        Extension: 'rels',\n        ContentType: 'application/vnd.openxmlformats-package.relationships+xml'\n      });\n      types.ele('Default', {\n        Extension: 'xml',\n        ContentType: 'application/xml'\n      });\n      types.ele('Override', {\n        PartName: '/xl/workbook.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'\n      });\n      types.ele('Override', {\n        PartName: '/docProps/app.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml'\n      });\n\n      for (i = l = 1, ref = this.book.sheets.length; 1 <= ref ? l <= ref : l >= ref; i = 1 <= ref ? ++l : --l) {\n        types.ele('Override', {\n          PartName: '/xl/worksheets/sheet' + i + '.xml',\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'\n        });\n      }\n\n      types.ele('Override', {\n        PartName: '/xl/sharedStrings.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'\n      });\n      types.ele('Override', {\n        PartName: '/docProps/core.xml',\n        ContentType: 'application/vnd.openxmlformats-package.core-properties+xml'\n      });\n      return types.end();\n    };\n\n    return ContentTypes;\n  }();\n\n  DocPropsApp = function () {\n    function DocPropsApp(book) {\n      this.book = book;\n    }\n\n    DocPropsApp.prototype.toxml = function () {\n      var i, l, props, ref, tmp;\n      props = xml.create('Properties', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      props.att('xmlns', 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties');\n      props.att('xmlns:vt', 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');\n      props.ele('Application', 'Microsoft Excel');\n      props.ele('DocSecurity', '0');\n      props.ele('ScaleCrop', 'false');\n      tmp = props.ele('HeadingPairs').ele('vt:vector', {\n        size: 2,\n        baseType: 'variant'\n      });\n      tmp.ele('vt:variant').ele('vt:lpstr', '工作表');\n      tmp.ele('vt:variant').ele('vt:i4', '' + this.book.sheets.length);\n      tmp = props.ele('TitlesOfParts').ele('vt:vector', {\n        size: this.book.sheets.length,\n        baseType: 'lpstr'\n      });\n\n      for (i = l = 1, ref = this.book.sheets.length; 1 <= ref ? l <= ref : l >= ref; i = 1 <= ref ? ++l : --l) {\n        tmp.ele('vt:lpstr', this.book.sheets[i - 1].name);\n      }\n\n      props.ele('Company');\n      props.ele('LinksUpToDate', 'false');\n      props.ele('SharedDoc', 'false');\n      props.ele('HyperlinksChanged', 'false');\n      props.ele('AppVersion', '12.0000');\n      return props.end();\n    };\n\n    return DocPropsApp;\n  }();\n\n  XlWorkbook = function () {\n    function XlWorkbook(book) {\n      this.book = book;\n    }\n\n    XlWorkbook.prototype.toxml = function () {\n      var definedNames, i, l, ref, tmp, wb;\n      wb = xml.create('workbook', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      wb.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      wb.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\n      wb.ele('fileVersion ', {\n        appName: 'xl',\n        lastEdited: '4',\n        lowestEdited: '4',\n        rupBuild: '4505'\n      });\n      wb.ele('workbookPr', {\n        filterPrivacy: '1',\n        defaultThemeVersion: '124226'\n      });\n      wb.ele('bookViews').ele('workbookView ', {\n        xWindow: '0',\n        yWindow: '90',\n        windowWidth: '19200',\n        windowHeight: '11640'\n      });\n      tmp = wb.ele('sheets');\n\n      for (i = l = 1, ref = this.book.sheets.length; 1 <= ref ? l <= ref : l >= ref; i = 1 <= ref ? ++l : --l) {\n        tmp.ele('sheet', {\n          name: this.book.sheets[i - 1].name,\n          sheetId: '' + i,\n          'r:id': 'rId' + i\n        });\n      }\n\n      definedNames = wb.ele('definedNames');\n      this.book.sheets.forEach(function (sheet, idx) {\n        if (sheet.autofilter) {\n          return definedNames.ele('definedName', {\n            name: '_xlnm._FilterDatabase',\n            hidden: '1',\n            localSheetId: idx\n          }).raw(\"'\" + sheet.name + \"'!\" + sheet.getRange());\n        }\n      });\n      wb.ele('calcPr', {\n        calcId: '124519'\n      });\n      return wb.end();\n    };\n\n    return XlWorkbook;\n  }();\n\n  XlRels = function () {\n    function XlRels(book) {\n      this.book = book;\n    }\n\n    XlRels.prototype.toxml = function () {\n      var i, l, ref, rs;\n      rs = xml.create('Relationships', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      rs.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');\n\n      for (i = l = 1, ref = this.book.sheets.length; 1 <= ref ? l <= ref : l >= ref; i = 1 <= ref ? ++l : --l) {\n        rs.ele('Relationship', {\n          Id: 'rId' + i,\n          Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',\n          Target: 'worksheets/sheet' + i + '.xml'\n        });\n      }\n\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 1),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n        Target: 'theme/theme1.xml'\n      });\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 2),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\n        Target: 'styles.xml'\n      });\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 3),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',\n        Target: 'sharedStrings.xml'\n      });\n      return rs.end();\n    };\n\n    return XlRels;\n  }();\n\n  SharedStrings = function () {\n    function SharedStrings() {\n      this.cache = {};\n      this.arr = [];\n    }\n\n    SharedStrings.prototype.str2id = function (s) {\n      var id;\n      id = this.cache[s];\n\n      if (id) {\n        return id;\n      } else {\n        this.arr.push(s);\n        this.cache[s] = this.arr.length;\n        return this.arr.length;\n      }\n    };\n\n    SharedStrings.prototype.toxml = function () {\n      var i, l, ref, si, sst;\n      sst = xml.create('sst', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      sst.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      sst.att('count', '' + this.arr.length);\n      sst.att('uniqueCount', '' + this.arr.length);\n\n      for (i = l = 0, ref = this.arr.length; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n        si = sst.ele('si');\n        si.ele('t', this.arr[i]);\n        si.ele('phoneticPr', {\n          fontId: 1,\n          type: 'noConversion'\n        });\n      }\n\n      return sst.end();\n    };\n\n    return SharedStrings;\n  }();\n\n  Sheet = function () {\n    function Sheet(book, name1, cols1, rows1) {\n      var i, j, l, n, ref, ref1;\n      this.book = book;\n      this.name = name1;\n      this.cols = cols1;\n      this.rows = rows1;\n      this.name = this.name.replace(/[\\/*:?\\[\\]]/g, '-');\n      this.data = {};\n\n      for (i = l = 1, ref = this.rows; 1 <= ref ? l <= ref : l >= ref; i = 1 <= ref ? ++l : --l) {\n        this.data[i] = {};\n\n        for (j = n = 1, ref1 = this.cols; 1 <= ref1 ? n <= ref1 : n >= ref1; j = 1 <= ref1 ? ++n : --n) {\n          this.data[i][j] = {\n            v: 0\n          };\n        }\n      }\n\n      this.merges = [];\n      this.col_wd = [];\n      this.row_ht = {};\n      this.styles = {};\n    }\n\n    Sheet.prototype.set = function (col, row, str) {\n      if (typeof str === 'string') {\n        if (str !== null && str !== '') {\n          this.data[row][col].v = this.book.ss.str2id('' + str);\n        }\n\n        return this.data[row][col].dataType = 'string';\n      } else if (typeof str === 'number') {\n        this.data[row][col].v = str;\n        return this.data[row][col].dataType = 'number';\n      } else {\n        this.data[row][col].v = str;\n      }\n    };\n\n    Sheet.prototype.merge = function (from_cell, to_cell) {\n      return this.merges.push({\n        from: from_cell,\n        to: to_cell\n      });\n    };\n\n    Sheet.prototype.width = function (col, wd) {\n      return this.col_wd.push({\n        c: col,\n        cw: wd\n      });\n    };\n\n    Sheet.prototype.height = function (row, ht) {\n      return this.row_ht[row] = ht;\n    };\n\n    Sheet.prototype.font = function (col, row, font_s) {\n      return this.styles['font_' + col + '_' + row] = this.book.st.font2id(font_s);\n    };\n\n    Sheet.prototype.fill = function (col, row, fill_s) {\n      return this.styles['fill_' + col + '_' + row] = this.book.st.fill2id(fill_s);\n    };\n\n    Sheet.prototype.border = function (col, row, bder_s) {\n      return this.styles['bder_' + col + '_' + row] = this.book.st.bder2id(bder_s);\n    };\n\n    Sheet.prototype.align = function (col, row, align_s) {\n      return this.styles['algn_' + col + '_' + row] = align_s;\n    };\n\n    Sheet.prototype.valign = function (col, row, valign_s) {\n      return this.styles['valgn_' + col + '_' + row] = valign_s;\n    };\n\n    Sheet.prototype.rotate = function (col, row, textRotation) {\n      return this.styles['rotate_' + col + '_' + row] = textRotation;\n    };\n\n    Sheet.prototype.wrap = function (col, row, wrap_s) {\n      return this.styles['wrap_' + col + '_' + row] = wrap_s;\n    };\n\n    Sheet.prototype.autoFilter = function (filter_s) {\n      return this.autoFilter = typeof filter_s === 'string' ? filter_s : this.getRange();\n    };\n\n    Sheet.prototype.style_id = function (col, row) {\n      var id, inx, style;\n      inx = '_' + col + '_' + row;\n      style = {\n        font_id: this.styles['font' + inx],\n        fill_id: this.styles['fill' + inx],\n        bder_id: this.styles['bder' + inx],\n        align: this.styles['algn' + inx],\n        valign: this.styles['valgn' + inx],\n        rotate: this.styles['rotate' + inx],\n        wrap: this.styles['wrap' + inx]\n      };\n      id = this.book.st.style2id(style);\n      return id;\n    };\n\n    Sheet.prototype.getRange = function () {\n      return '$A$1:$' + tool.i2a(this.cols) + '$' + this.rows;\n    };\n\n    Sheet.prototype.toxml = function () {\n      var c, cols, cw, ht, i, ix, j, l, len, len1, m, mc, n, p, q, r, ref, ref1, ref2, ref3, sd, sid, ws;\n      ws = xml.create('worksheet', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      ws.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      ws.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\n      ws.ele('dimension', {\n        ref: 'A1'\n      });\n      ws.ele('sheetViews').ele('sheetView', {\n        workbookViewId: '0'\n      });\n      ws.ele('sheetFormatPr', {\n        defaultRowHeight: '13.5'\n      });\n\n      if (this.col_wd.length > 0) {\n        cols = ws.ele('cols');\n        ref = this.col_wd;\n\n        for (l = 0, len = ref.length; l < len; l++) {\n          cw = ref[l];\n          cols.ele('col', {\n            min: '' + cw.c,\n            max: '' + cw.c,\n            width: cw.cw,\n            customWidth: '1'\n          });\n        }\n      }\n\n      sd = ws.ele('sheetData');\n\n      for (i = n = 1, ref1 = this.rows; 1 <= ref1 ? n <= ref1 : n >= ref1; i = 1 <= ref1 ? ++n : --n) {\n        r = sd.ele('row', {\n          r: '' + i,\n          spans: '1:' + this.cols\n        });\n        ht = this.row_ht[i];\n\n        if (ht) {\n          r.att('ht', ht);\n          r.att('customHeight', '1');\n        }\n\n        for (j = p = 1, ref2 = this.cols; 1 <= ref2 ? p <= ref2 : p >= ref2; j = 1 <= ref2 ? ++p : --p) {\n          ix = this.data[i][j];\n          sid = this.style_id(j, i);\n\n          if (ix.v !== null && ix.v !== void 0 || sid !== 1) {\n            c = r.ele('c', {\n              r: '' + tool.i2a(j) + i\n            });\n\n            if (sid !== 1) {\n              c.att('s', '' + (sid - 1));\n            }\n\n            if (ix.dataType === 'string') {\n              c.att('t', 's');\n              c.ele('v', '' + (ix.v - 1));\n            } else if (ix.dataType === 'number') {\n              c.ele('v', '' + ix.v);\n            }\n          }\n        }\n      }\n\n      if (this.merges.length > 0) {\n        mc = ws.ele('mergeCells', {\n          count: this.merges.length\n        });\n        ref3 = this.merges;\n\n        for (q = 0, len1 = ref3.length; q < len1; q++) {\n          m = ref3[q];\n          mc.ele('mergeCell', {\n            ref: '' + tool.i2a(m.from.col) + m.from.row + ':' + tool.i2a(m.to.col) + m.to.row\n          });\n        }\n      }\n\n      if (typeof this.autoFilter === 'string') {\n        ws.ele('autoFilter', {\n          ref: this.autoFilter\n        });\n      }\n\n      ws.ele('phoneticPr', {\n        fontId: '1',\n        type: 'noConversion'\n      });\n      ws.ele('pageMargins', {\n        left: '0.7',\n        right: '0.7',\n        top: '0.75',\n        bottom: '0.75',\n        header: '0.3',\n        footer: '0.3'\n      });\n      ws.ele('pageSetup', {\n        paperSize: '9',\n        orientation: 'portrait',\n        horizontalDpi: '200',\n        verticalDpi: '200'\n      });\n      return ws.end();\n    };\n\n    return Sheet;\n  }();\n\n  Style = function () {\n    function Style(book) {\n      this.book = book;\n      this.cache = {};\n      this.mfonts = [];\n      this.mfills = [];\n      this.mbders = [];\n      this.mstyle = [];\n      this.with_default();\n    }\n\n    Style.prototype.with_default = function () {\n      this.def_font_id = this.font2id(null);\n      this.def_fill_id = this.fill2id(null);\n      this.def_bder_id = this.bder2id(null);\n      this.def_align = '-';\n      this.def_valign = '-';\n      this.def_rotate = '-';\n      this.def_wrap = '-';\n      return this.def_style_id = this.style2id({\n        font_id: this.def_font_id,\n        fill_id: this.def_fill_id,\n        bder_id: this.def_bder_id,\n        align: this.def_align,\n        valign: this.def_valign,\n        rotate: this.def_rotate\n      });\n    };\n\n    Style.prototype.font2id = function (font) {\n      var id, k;\n      font || (font = {});\n      font.bold || (font.bold = '-');\n      font.iter || (font.iter = '-');\n      font.sz || (font.sz = '11');\n      font.color || (font.color = '-');\n      font.name || (font.name = '宋体');\n      font.scheme || (font.scheme = 'minor');\n      font.family || (font.family = '2');\n      k = 'font_' + font.bold + font.iter + font.sz + font.color + font.name + font.scheme + font.family;\n      id = this.cache[k];\n\n      if (id) {\n        return id;\n      } else {\n        this.mfonts.push(font);\n        this.cache[k] = this.mfonts.length;\n        return this.mfonts.length;\n      }\n    };\n\n    Style.prototype.fill2id = function (fill) {\n      var id, k;\n      fill || (fill = {});\n      fill.type || (fill.type = 'none');\n      fill.bgColor || (fill.bgColor = '-');\n      fill.fgColor || (fill.fgColor = '-');\n      k = 'fill_' + fill.type + fill.bgColor + fill.fgColor;\n      id = this.cache[k];\n\n      if (id) {\n        return id;\n      } else {\n        this.mfills.push(fill);\n        this.cache[k] = this.mfills.length;\n        return this.mfills.length;\n      }\n    };\n\n    Style.prototype.bder2id = function (bder) {\n      var id, k;\n      bder || (bder = {});\n      bder.left || (bder.left = '-');\n      bder.right || (bder.right = '-');\n      bder.top || (bder.top = '-');\n      bder.bottom || (bder.bottom = '-');\n      k = 'bder_' + bder.left + '_' + bder.right + '_' + bder.top + '_' + bder.bottom;\n      id = this.cache[k];\n\n      if (id) {\n        return id;\n      } else {\n        this.mbders.push(bder);\n        this.cache[k] = this.mbders.length;\n        return this.mbders.length;\n      }\n    };\n\n    Style.prototype.style2id = function (style) {\n      var id, k;\n      style.align || (style.align = this.def_align);\n      style.valign || (style.valign = this.def_valign);\n      style.rotate || (style.rotate = this.def_rotate);\n      style.wrap || (style.wrap = this.def_wrap);\n      style.font_id || (style.font_id = this.def_font_id);\n      style.fill_id || (style.fill_id = this.def_fill_id);\n      style.bder_id || (style.bder_id = this.def_bder_id);\n      k = 's_' + style.font_id + '_' + style.fill_id + '_' + style.bder_id + '_' + style.align + '_' + style.valign + '_' + style.wrap + '_' + style.rotate;\n      id = this.cache[k];\n\n      if (id) {\n        return id;\n      } else {\n        this.mstyle.push(style);\n        this.cache[k] = this.mstyle.length;\n        return this.mstyle.length;\n      }\n    };\n\n    Style.prototype.toxml = function () {\n      var bders, cs, e, ea, es, fills, fonts, l, len, len1, len2, len3, n, o, p, q, ref, ref1, ref2, ref3, ss;\n      ss = xml.create('styleSheet', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      ss.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      fonts = ss.ele('fonts', {\n        count: this.mfonts.length\n      });\n      ref = this.mfonts;\n\n      for (l = 0, len = ref.length; l < len; l++) {\n        o = ref[l];\n        e = fonts.ele('font');\n\n        if (o.bold !== '-') {\n          e.ele('b');\n        }\n\n        if (o.iter !== '-') {\n          e.ele('i');\n        }\n\n        e.ele('sz', {\n          val: o.sz\n        });\n\n        if (o.color !== '-') {\n          e.ele('color', {\n            rgb: o.color\n          });\n        }\n\n        e.ele('name', {\n          val: o.name\n        });\n        e.ele('family', {\n          val: o.family\n        });\n        e.ele('charset', {\n          val: '134'\n        });\n\n        if (o.scheme !== '-') {\n          e.ele('scheme', {\n            val: 'minor'\n          });\n        }\n      }\n\n      fills = ss.ele('fills', {\n        count: this.mfills.length + 2\n      });\n      fills.ele('fill').ele('patternFill', {\n        patternType: 'none'\n      });\n      fills.ele('fill').ele('patternFill', {\n        patternType: 'gray125'\n      });\n      ref1 = this.mfills;\n\n      for (n = 0, len1 = ref1.length; n < len1; n++) {\n        o = ref1[n];\n        e = fills.ele('fill');\n        es = e.ele('patternFill', {\n          patternType: o.type\n        });\n\n        if (o.fgColor !== '-') {\n          es.ele('fgColor', {\n            rgb: o.fgColor\n          });\n        }\n\n        if (o.bgColor !== '-') {\n          es.ele('bgColor', {\n            indexed: o.bgColor\n          });\n        }\n      }\n\n      bders = ss.ele('borders', {\n        count: this.mbders.length\n      });\n      ref2 = this.mbders;\n\n      for (p = 0, len2 = ref2.length; p < len2; p++) {\n        o = ref2[p];\n        e = bders.ele('border');\n\n        if (o.left !== '-') {\n          e.ele('left', {\n            style: o.left\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('left');\n        }\n\n        if (o.right !== '-') {\n          e.ele('right', {\n            style: o.right\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('right');\n        }\n\n        if (o.top !== '-') {\n          e.ele('top', {\n            style: o.top\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('top');\n        }\n\n        if (o.bottom !== '-') {\n          e.ele('bottom', {\n            style: o.bottom\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('bottom');\n        }\n\n        e.ele('diagonal');\n      }\n\n      ss.ele('cellStyleXfs', {\n        count: '1'\n      }).ele('xf', {\n        numFmtId: '0',\n        fontId: '0',\n        fillId: '0',\n        borderId: '0'\n      }).ele('alignment', {\n        vertical: 'center'\n      });\n      cs = ss.ele('cellXfs', {\n        count: this.mstyle.length\n      });\n      ref3 = this.mstyle;\n\n      for (q = 0, len3 = ref3.length; q < len3; q++) {\n        o = ref3[q];\n        e = cs.ele('xf', {\n          numFmtId: '0',\n          fontId: o.font_id - 1,\n          fillId: o.fill_id + 1,\n          borderId: o.bder_id - 1,\n          xfId: '0'\n        });\n\n        if (o.font_id !== 1) {\n          e.att('applyFont', '1');\n        }\n\n        if (o.fill_id !== 1) {\n          e.att('applyFill', '1');\n        }\n\n        if (o.bder_id !== 1) {\n          e.att('applyBorder', '1');\n        }\n\n        if (o.align !== '-' || o.valign !== '-' || o.wrap !== '-') {\n          e.att('applyAlignment', '1');\n          ea = e.ele('alignment', {\n            textRotation: o.rotate === '-' ? '0' : o.rotate,\n            horizontal: o.align === '-' ? 'left' : o.align,\n            vertical: o.valign === '-' ? 'top' : o.valign\n          });\n\n          if (o.wrap !== '-') {\n            ea.att('wrapText', '1');\n          }\n        }\n      }\n\n      ss.ele('cellStyles', {\n        count: '1'\n      }).ele('cellStyle', {\n        name: '常规',\n        xfId: '0',\n        builtinId: '0'\n      });\n      ss.ele('dxfs', {\n        count: '0'\n      });\n      ss.ele('tableStyles', {\n        count: '0',\n        defaultTableStyle: 'TableStyleMedium9',\n        defaultPivotStyle: 'PivotStyleLight16'\n      });\n      return ss.end();\n    };\n\n    return Style;\n  }();\n\n  Workbook = function () {\n    function Workbook(fpath1, fname1) {\n      this.fpath = fpath1;\n      this.fname = fname1;\n      this.generate = bind(this.generate, this);\n      this.save = bind(this.save, this);\n      this.id = '' + parseInt(Math.random() * 9999999);\n      this.sheets = [];\n      this.ss = new SharedStrings();\n      this.ct = new ContentTypes(this);\n      this.da = new DocPropsApp(this);\n      this.wb = new XlWorkbook(this);\n      this.re = new XlRels(this);\n      this.st = new Style(this);\n    }\n\n    Workbook.prototype.createSheet = function (name, cols, rows) {\n      var sheet;\n      sheet = new Sheet(this, name, cols, rows);\n      this.sheets.push(sheet);\n      return sheet;\n    };\n\n    Workbook.prototype.save = function (cb) {\n      var target;\n      target = this.fpath + '/' + this.fname;\n      return this.generate(function (err, zip) {\n        var buffer;\n        buffer = zip.generate({\n          type: 'nodebuffer'\n        });\n        return require('fs').writeFile(target, buffer, cb);\n      });\n    };\n\n    Workbook.prototype.generate = function (cb) {\n      var i, key, l, ref, zip;\n      zip = new JSZip();\n\n      for (key in baseXl) {\n        zip.file(key, baseXl[key]);\n      }\n\n      zip.file('[Content_Types].xml', this.ct.toxml());\n      zip.file('docProps/app.xml', this.da.toxml());\n      zip.file('xl/workbook.xml', this.wb.toxml());\n      zip.file('xl/sharedStrings.xml', this.ss.toxml());\n      zip.file('xl/_rels/workbook.xml.rels', this.re.toxml());\n\n      for (i = l = 0, ref = this.sheets.length; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n        zip.file('xl/worksheets/sheet' + (i + 1) + '.xml', this.sheets[i].toxml());\n      }\n\n      zip.file('xl/styles.xml', this.st.toxml());\n      return cb(null, zip);\n    };\n\n    Workbook.prototype.cancel = function () {\n      return console.error(\"workbook.cancel() is deprecated\");\n    };\n\n    return Workbook;\n  }();\n\n  module.exports = {\n    createWorkbook: function createWorkbook(fpath, fname) {\n      return new Workbook(fpath, fname);\n    }\n  };\n  baseXl = {\n    '_rels/.rels': '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/></Relationships>',\n    'docProps/core.xml': '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><dc:creator>Administrator</dc:creator><cp:lastModifiedBy></cp:lastModifiedBy><dcterms:created xsi:type=\"dcterms:W3CDTF\">2006-09-13T11:21:51Z</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">2006-09-13T11:21:55Z</dcterms:modified></cp:coreProperties>',\n    'xl/theme/theme1.xml': '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office 主题\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>',\n    'xl/styles.xml': '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><fonts count=\"2\"><font><sz val=\"11\"/><color theme=\"1\"/><name val=\"宋体\"/><family val=\"2\"/><charset val=\"134\"/><scheme val=\"minor\"/></font><font><sz val=\"9\"/><name val=\"宋体\"/><family val=\"2\"/><charset val=\"134\"/><scheme val=\"minor\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"><alignment vertical=\"center\"/></xf></cellStyleXfs><cellXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\"><alignment vertical=\"center\"/></xf></cellXfs><cellStyles count=\"1\"><cellStyle name=\"常规\" xfId=\"0\" builtinId=\"0\"/></cellStyles><dxfs count=\"0\"/><tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/></styleSheet>'\n  };\n}).call(this);","map":null,"metadata":{},"sourceType":"script"}