{"ast":null,"code":"module.exports = {\n  // assume passed in an array of row objects\n  getTable: function getTable(rows, tblOpts) {\n    tblOpts = tblOpts || {};\n    var self = this;\n    return self._getBase(rows.map(function (row) {\n      return self._getRow(row.map(function (cell) {\n        cell = cell || {};\n\n        if (typeof cell === 'string' || typeof cell === 'number') {\n          var val = cell;\n          cell = {\n            val: val\n          };\n        }\n\n        return self._getCell(cell.val, cell.opts, tblOpts);\n      }), tblOpts);\n    }), self._getColSpecs(rows, tblOpts), tblOpts);\n  },\n  _getBase: function _getBase(rowSpecs, colSpecs, opts) {\n    var self = this;\n    var baseTable = {\n      \"w:tbl\": {\n        \"w:tblPr\": {\n          \"w:tblStyle\": {\n            \"@w:val\": \"a3\"\n          },\n          \"w:tblW\": {\n            \"@w:w\": \"0\",\n            \"@w:type\": \"auto\"\n          },\n          \"w:tblLook\": {\n            \"@w:val\": \"04A0\",\n            \"@w:firstRow\": \"1\",\n            \"@w:lastRow\": \"0\",\n            \"@w:firstColumn\": \"1\",\n            \"@w:lastColumn\": \"0\",\n            \"@w:noHBand\": \"0\",\n            \"@w:noVBand\": \"1\"\n          }\n        },\n        \"w:tblGrid\": {\n          \"#list\": colSpecs\n        },\n        \"#list\": [rowSpecs]\n      }\n    };\n\n    if (opts.borders) {\n      baseTable[\"w:tbl\"][\"w:tblPr\"][\"w:tblBorders\"] = {\n        \"w:top\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        },\n        \"w:bottom\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        },\n        \"w:left\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        },\n        \"w:right\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        },\n        \"w:insideH\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        },\n        \"w:insideV\": {\n          \"@w:val\": \"single\",\n          \"@w:sz\": \"12\",\n          \"@w:space\": \"0\",\n          \"@w:color\": \"000000\"\n        }\n      };\n    }\n\n    if (opts.rtl) {\n      baseTable[\"w:tbl\"][\"w:tblPr\"][\"w:bidiVisual\"] = {};\n    }\n\n    return baseTable;\n  },\n  _getColSpecs: function _getColSpecs(cols, opts) {\n    var self = this;\n    return cols[0].map(function (col, idx) {\n      return self._tblGrid(opts, col);\n    });\n  },\n  // TODO\n  _tblGrid: function _tblGrid(opts, col) {\n    return {\n      \"w:gridCol\": {\n        \"@w:w\": col.opts.cellColWidth || opts.tableColWidth || \"1\"\n      }\n    };\n  },\n  _getRow: function _getRow(cells, opts) {\n    return {\n      \"w:tr\": {\n        \"@w:rsidR\": \"00995B51\",\n        \"@w:rsidTr\": \"007F1D13\",\n        \"#list\": [cells] // populate this with an array of table cell objects\n\n      }\n    };\n  },\n  _getCell: function _getCell(val, opts, tblOpts) {\n    opts = opts || {}; // var b = {};\n    // if (opts.b) {\n    //   b = {\n    //     \"w:tc\": {\n    //       \"w:p\": {\n    //         \"w:r\": {\n    //           \"w:rPr\": {\n    //             \"w:b\": {}\n    //           }\n    //         }\n    //       }\n    //     }\n    //   }\n    // }\n\n    var cellObj = {\n      \"w:tc\": {\n        \"w:tcPr\": {\n          \"w:tcW\": {\n            \"@w:w\": opts.cellColWidth || tblOpts.tableColWidth || \"0\",\n            \"@w:type\": \"dxa\"\n          },\n          \"w:gridSpan\": {\n            \"@w:val\": opts.gridSpan || \"1\"\n          },\n          \"w:vAlign\": {\n            \"@w:val\": opts.vAlign || \"top\"\n          },\n          \"w:shd\": {\n            \"@w:val\": \"clear\",\n            \"@w:color\": \"auto\",\n            \"@w:fill\": opts.shd && opts.shd.fill || \"\",\n            \"@w:themeFill\": opts.shd && opts.shd.themeFill || \"\",\n            \"@w:themeFillTint\": opts.shd && opts.shd.themeFillTint || \"\"\n          }\n        },\n        \"w:p\": {\n          \"@w:rsidR\": \"00995B51\",\n          \"@w:rsidRPr\": \"00722E63\",\n          \"@w:rsidRDefault\": \"00995B51\",\n          \"w:pPr\": {\n            \"w:jc\": {\n              \"@w:val\": opts.align || tblOpts.tableAlign || \"center\"\n            } // \"w:rPr\": {\n            //   \"w:rFonts\": {\n            //     \"@w:asciiTheme\": \"majorEastAsia\",\n            //     \"@w:eastAsiaTheme\": \"majorEastAsia\",\n            //     \"@w:hAnsiTheme\": \"majorEastAsia\"\n            //   },\n            //   // \"w:b\": {},\n            //   \"w:sz\": {\n            //     \"@w:val\": \"24\"\n            //   },\n            //   \"w:szCs\": {\n            //     \"@w:val\": \"24\"\n            //   }\n            // }\n\n          },\n          \"w:r\": {\n            \"@w:rsidRPr\": \"00722E63\",\n            \"w:rPr\": {\n              \"w:rFonts\": {\n                \"@w:ascii\": opts.fontFamily || tblOpts.tableFontFamily || \"宋体\",\n                \"@w:hAnsi\": opts.fontFamily || tblOpts.tableFontFamily || \"宋体\"\n              },\n              \"w:color\": {\n                \"@w:val\": opts.color || tblOpts.tableColor || \"000\"\n              },\n              \"w:b\": {},\n              \"w:sz\": {\n                \"@w:val\": opts.sz || tblOpts.sz || \"24\"\n              },\n              \"w:szCs\": {\n                \"@w:val\": opts.sz || tblOpts.sz || \"24\"\n              }\n            },\n            \"w:t\": val\n          }\n        }\n      }\n    };\n\n    if (!opts.b) {\n      delete cellObj[\"w:tc\"][\"w:p\"][\"w:r\"][\"w:rPr\"][\"w:b\"];\n    }\n\n    if (tblOpts.rtl) {\n      cellObj[\"w:tc\"][\"w:p\"][\"w:pPr\"][\"w:bidi\"] = {\n        \"@w:val\": \"1\"\n      };\n    }\n\n    if (opts.rtl) {\n      cellObj[\"w:tc\"][\"w:p\"][\"w:r\"][\"w:rPr\"][\"w:rtl\"] = {\n        \"@w:val\": \"1\"\n      };\n    }\n\n    return cellObj;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}