{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validatePath = exports.validateElement = exports.openDocApp = exports.Events = undefined;\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _os = require('os');\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _execa = require('execa');\n\nvar _execa2 = _interopRequireDefault(_execa);\n\nvar _minimatch = require('minimatch');\n\nvar _minimatch2 = _interopRequireDefault(_minimatch);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/* eslint-disable no-unused-expressions */\n\n/**\n * Open the doc app\n */\n\n\nfunction openDocApp(file) {\n  _os2.default.platform() === 'darwin' ? _execa2.default.shell('open -a pages ' + _path2.default.resolve(file)) : null;\n}\n/**\n * Document element\n * @param {Object} element \n */\n\n\nfunction validateElement(element) {\n  if (!element) {\n    throw new Error('Render method expected an element.');\n  }\n\n  if (typeof element === 'string') {\n    throw new Error(\"Invalid component element. Instead of passing string like 'text', pass a class or functional component. For example - <Document />\");\n  }\n\n  return true;\n}\n/**\n * Filepath for the document\n * @param {string} filePath \n */\n\n\nfunction validatePath(filePath) {\n  if (filePath === null || filePath === undefined) {\n    throw new Error('Please specify a file path for the document');\n  }\n\n  var fileName = _path2.default.basename(filePath);\n\n  var pattern = '*.docx';\n\n  if (!(0, _minimatch2.default)(fileName, pattern)) {\n    throw new Error('Invalid filename \\'' + _path2.default.basename(filePath) + '\\'. Make sure the extension is \\'.docx\\'');\n  }\n\n  return true;\n}\n\nfunction Events(filePath, resolve, reject) {\n  return {\n    finalize: function finalize() {\n      console.log(\"\\u2728  Word document created at \" + _path2.default.resolve(filePath) + '.');\n      resolve();\n    },\n    error: function error() {\n      console.log('An error occurred while generating the document.');\n      reject();\n    }\n  };\n}\n\nexports.Events = Events;\nexports.openDocApp = openDocApp;\nexports.validateElement = validateElement;\nexports.validatePath = validatePath;","map":null,"metadata":{},"sourceType":"script"}