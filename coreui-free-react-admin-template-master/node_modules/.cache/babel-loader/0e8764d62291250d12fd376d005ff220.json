{"ast":null,"code":"//\n// officegen: All the code to generate DOCX files.\n//\n// Please refer to README.md for this module's documentations.\n//\n// NOTE:\n// - Before changing this code please refer to the hacking the code section on README.md.\n//\n// Copyright (c) 2013 Ziv Barber;\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and associated documentation files (the\n// 'Software'), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to\n// the following conditions:\n//\n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * Basicgen plugin to create docx files (Microsoft World).\n */\nvar baseobj = require(\"./basicgen.js\");\n\nvar msdoc = require(\"./msofficegen.js\");\n\nvar docxP = require('./docx-p.js');\n\nvar docxTable = require('./docxtable.js');\n\nvar xmlBuilder = require('xmlbuilder');\n\nvar docplugman = require('./docplug'); // Officegen docx plugins:\n\n\nvar plugHeadfoot = require('./docxplg-headfoot'); // BMK_DOCX_PLUG:\n\n\nif (!String.prototype.encodeHTML) {\n  String.prototype.encodeHTML = function () {\n    return this.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n  };\n}\n\nvar defaultStyleXML = '<w:styles xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:docDefaults><w:rPrDefault><w:rPr><w:rFonts w:asciiTheme=\"minorHAnsi\" w:eastAsiaTheme=\"minorHAnsi\" w:hAnsiTheme=\"minorHAnsi\" w:cstheme=\"minorBidi\"/><w:sz w:val=\"22\"/><w:szCs w:val=\"22\"/><w:lang w:val=\"en-US\" w:eastAsia=\"en-US\" w:bidi=\"en-US\"/></w:rPr></w:rPrDefault><w:pPrDefault><w:pPr><w:spacing w:after=\"200\" w:line=\"276\" w:lineRule=\"auto\"/></w:pPr></w:pPrDefault></w:docDefaults><w:latentStyles w:defLockedState=\"0\" w:defUIPriority=\"99\" w:defSemiHidden=\"1\" w:defUnhideWhenUsed=\"1\" w:defQFormat=\"0\" w:count=\"267\"><w:lsdException w:name=\"Normal\" w:semiHidden=\"0\" w:uiPriority=\"0\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 1\" w:semiHidden=\"0\" w:uiPriority=\"9\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 2\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 3\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 4\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 5\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 6\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 7\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 8\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 9\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"toc 1\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 2\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 3\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 4\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 5\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 6\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 7\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 8\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 9\" w:uiPriority=\"39\"/><w:lsdException w:name=\"caption\" w:uiPriority=\"35\" w:qFormat=\"1\"/><w:lsdException w:name=\"Title\" w:semiHidden=\"0\" w:uiPriority=\"10\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Default Paragraph Font\" w:uiPriority=\"1\"/><w:lsdException w:name=\"Subtitle\" w:semiHidden=\"0\" w:uiPriority=\"11\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Strong\" w:semiHidden=\"0\" w:uiPriority=\"22\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"20\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Table Grid\" w:semiHidden=\"0\" w:uiPriority=\"59\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Placeholder Text\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"No Spacing\" w:semiHidden=\"0\" w:uiPriority=\"1\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Light Shading\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Revision\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"List Paragraph\" w:semiHidden=\"0\" w:uiPriority=\"34\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Quote\" w:semiHidden=\"0\" w:uiPriority=\"29\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Quote\" w:semiHidden=\"0\" w:uiPriority=\"30\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Medium List 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Subtle Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"19\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"21\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Subtle Reference\" w:semiHidden=\"0\" w:uiPriority=\"31\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Reference\" w:semiHidden=\"0\" w:uiPriority=\"32\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Book Title\" w:semiHidden=\"0\" w:uiPriority=\"33\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Bibliography\" w:uiPriority=\"37\"/><w:lsdException w:name=\"TOC Heading\" w:uiPriority=\"39\" w:qFormat=\"1\"/></w:latentStyles><w:style w:type=\"paragraph\" w:default=\"1\" w:styleId=\"Normal\"><w:name w:val=\"Normal\"/><w:qFormat/><w:rsid w:val=\"00A02F19\"/></w:style><w:style w:type=\"character\" w:default=\"1\" w:styleId=\"DefaultParagraphFont\"><w:name w:val=\"Default Paragraph Font\"/><w:uiPriority w:val=\"1\"/><w:semiHidden/><w:unhideWhenUsed/></w:style><w:style w:type=\"table\" w:default=\"1\" w:styleId=\"TableNormal\"><w:name w:val=\"Normal Table\"/><w:uiPriority w:val=\"99\"/><w:semiHidden/><w:unhideWhenUsed/><w:qFormat/><w:tblPr><w:tblInd w:w=\"0\" w:type=\"dxa\"/><w:tblCellMar><w:top w:w=\"0\" w:type=\"dxa\"/><w:left w:w=\"108\" w:type=\"dxa\"/><w:bottom w:w=\"0\" w:type=\"dxa\"/><w:right w:w=\"108\" w:type=\"dxa\"/></w:tblCellMar></w:tblPr></w:style><w:style w:type=\"numbering\" w:default=\"1\" w:styleId=\"NoList\"><w:name w:val=\"No List\"/><w:uiPriority w:val=\"99\"/><w:semiHidden/><w:unhideWhenUsed/></w:style></w:styles>';\n;\n/**\n * Extend officegen object with DOCX support.\n * <br /><br />\n *\n * This method extending the given officegen object to create DOCX document.\n *\n * @param[in] genobj The object to extend.\n * @param[in] new_type The type of object to create.\n * @param[in] options The object's options.\n * @param[in] gen_private Access to the internals of this object.\n * @param[in] type_info Additional information about this type.\n * @constructor\n * @name makeDocx\n */\n\nfunction makeDocx(genobj, new_type, options, gen_private, type_info) {\n  /**\n   * Prepare the default data.\n   * @param {object} docpluginman Access to the document plugins manager.\n   */\n  function setDefaultDocValues(docpluginman) {\n    var pptxData = docpluginman.getDataStorage(); // Please put any setting that API can override here:\n  }\n  /**\n   * Prepare everything to generate a docx zip.\n   */\n\n\n  function cbPrepareDocxToGenerate() {\n    // Tell all the features (plugins) that we are about to generate a new document zip:\n    gen_private.features.type.docx.emitEvent('beforeGen', genobj); // Allow some plugins to do more stuff after all the plugins added their data:\n\n    gen_private.features.type.docx.emitEvent('beforeGenFinal', genobj);\n  }\n  /**\n   * ???.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxFontsTable(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<w:fonts xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:font w:name=\"Calibri\"><w:panose1 w:val=\"020F0502020204030204\"/><w:charset w:val=\"00\"/><w:family w:val=\"swiss\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"A00002EF\" w:usb1=\"4000207B\" w:usb2=\"00000000\" w:usb3=\"00000000\" w:csb0=\"0000009F\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Arial\"><w:panose1 w:val=\"020B0604020202020204\"/><w:charset w:val=\"00\"/><w:family w:val=\"swiss\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"20002A87\" w:usb1=\"80000000\" w:usb2=\"00000008\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Times New Roman\"><w:panose1 w:val=\"02020603050405020304\"/><w:charset w:val=\"00\"/><w:family w:val=\"roman\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"20002A87\" w:usb1=\"80000000\" w:usb2=\"00000008\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Cambria\"><w:panose1 w:val=\"02040503050406030204\"/><w:charset w:val=\"00\"/><w:family w:val=\"roman\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"A00002EF\" w:usb1=\"4000004B\" w:usb2=\"00000000\" w:usb3=\"00000000\" w:csb0=\"0000009F\" w:csb1=\"00000000\"/></w:font></w:fonts>';\n  }\n  /**\n   * ???.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxSettings(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<w:settings xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:sl=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\"><w:zoom w:percent=\"120\"/><w:defaultTabStop w:val=\"720\"/><w:characterSpacingControl w:val=\"doNotCompress\"/><w:compat/><w:rsids><w:rsidRoot w:val=\"00A94AF2\"/><w:rsid w:val=\"00A02F19\"/><w:rsid w:val=\"00A94AF2\"/></w:rsids><m:mathPr><m:mathFont m:val=\"Cambria Math\"/><m:brkBin m:val=\"before\"/><m:brkBinSub m:val=\"--\"/><m:smallFrac m:val=\"off\"/><m:dispDef/><m:lMargin m:val=\"0\"/><m:rMargin m:val=\"0\"/><m:defJc m:val=\"centerGroup\"/><m:wrapIndent m:val=\"1440\"/><m:intLim m:val=\"subSup\"/><m:naryLim m:val=\"undOvr\"/></m:mathPr><w:themeFontLang w:val=\"en-US\" w:bidi=\"en-US\"/><w:clrSchemeMapping w:bg1=\"light1\" w:t1=\"dark1\" w:bg2=\"light2\" w:t2=\"dark2\" w:accent1=\"accent1\" w:accent2=\"accent2\" w:accent3=\"accent3\" w:accent4=\"accent4\" w:accent5=\"accent5\" w:accent6=\"accent6\" w:hyperlink=\"hyperlink\" w:followedHyperlink=\"followedHyperlink\"/><w:shapeDefaults><o:shapedefaults v:ext=\"edit\" spidmax=\"2050\"/><o:shapelayout v:ext=\"edit\"><o:idmap v:ext=\"edit\" data=\"1\"/></o:shapelayout></w:shapeDefaults><w:decimalSymbol w:val=\".\"/><w:listSeparator w:val=\",\"/></w:settings>';\n  } // NJC - added to support bullets\n\n\n  function cbMakeDocxNumbers(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<w:numbering xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\" xmlns:mo=\"http://schemas.microsoft.com/office/mac/office/2008/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\" xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\" mc:Ignorable=\"w14 w15 wp14\"><w:abstractNum w:abstractNumId=\"0\"><w:nsid w:val=\"709F643A\"/><w:multiLevelType w:val=\"hybridMultilevel\"/><w:tmpl w:val=\"B8B464D0\"/><w:lvl w:ilvl=\"0\" w:tplc=\"04090001\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"720\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Symbol\" w:hAnsi=\"Symbol\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"1\" w:tplc=\"04090003\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"o\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"1440\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Courier New\" w:hAnsi=\"Courier New\" w:cs=\"Courier New\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"2\" w:tplc=\"04090005\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"2160\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Wingdings\" w:hAnsi=\"Wingdings\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"3\" w:tplc=\"04090001\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"2880\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Symbol\" w:hAnsi=\"Symbol\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"4\" w:tplc=\"04090003\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"o\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"3600\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Courier New\" w:hAnsi=\"Courier New\" w:cs=\"Courier New\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"5\" w:tplc=\"04090005\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"4320\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Wingdings\" w:hAnsi=\"Wingdings\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"6\" w:tplc=\"04090001\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"5040\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Symbol\" w:hAnsi=\"Symbol\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"7\" w:tplc=\"04090003\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"o\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"5760\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Courier New\" w:hAnsi=\"Courier New\" w:cs=\"Courier New\" w:hint=\"default\"/></w:rPr></w:lvl><w:lvl w:ilvl=\"8\" w:tplc=\"04090005\" w:tentative=\"1\"><w:start w:val=\"1\"/><w:numFmt w:val=\"bullet\"/><w:lvlText w:val=\"\"/><w:lvlJc w:val=\"left\"/><w:pPr><w:ind w:left=\"6480\" w:hanging=\"360\"/></w:pPr><w:rPr><w:rFonts w:ascii=\"Wingdings\" w:hAnsi=\"Wingdings\" w:hint=\"default\"/></w:rPr></w:lvl></w:abstractNum><w:num w:numId=\"1\"><w:abstractNumId w:val=\"0\"/></w:num></w:numbering>';\n  }\n  /**\n   * ???.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxWeb(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<w:webSettings xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:optimizeForBrowser/></w:webSettings>';\n  }\n  /**\n   * ???.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxStyles(data) {\n    var styleXML = data && data.styleXML || defaultStyleXML;\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + styleXML;\n  }\n  /**\n   * ???.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxApp(data) {\n    var userName = genobj.options.author || genobj.options.creator || 'officegen';\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><Template>Normal.dotm</Template><TotalTime>1</TotalTime><Pages>1</Pages><Words>0</Words><Characters>0</Characters><Application>Microsoft Office Word</Application><DocSecurity>0</DocSecurity><Lines>1</Lines><Paragraphs>1</Paragraphs><ScaleCrop>false</ScaleCrop><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><CharactersWithSpaces>0</CharactersWithSpaces><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\n    return outString;\n  }\n  /**\n   * Create the document's itself resource.\n   *\n   * @param[in] data Ignored by this callback function.\n   * @return Text string.\n   */\n\n\n  function cbMakeDocxDocument(data) {\n    data.docStartExtra = data.docStartExtra || '';\n    data.docEndExtra = data.docEndExtra || '';\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<w:' + data.docType + ' xmlns:ve=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\">' + data.docStartExtra;\n    var objs_list = data.data;\n    var bookmarkId = 0; // In case of an empty document - just place an empty paragraph:\n\n    if (!objs_list.length) {\n      outString += '<w:p w:rsidR=\"009F2180\" w:rsidRDefault=\"009F2180\">';\n\n      if (data.pStyleDef) {\n        outString += '<w:pPr><w:pStyle w:val=\"' + data.pStyleDef + '\"/></w:pPr>';\n      } // Endif.\n\n\n      outString += '</w:p>';\n    } // Endif.\n    // Work on all the stored paragraphs inside this document:\n\n\n    for (var i = 0, total_size = objs_list.length; i < total_size; i++) {\n      if (objs_list[i] && objs_list[i].type === 'table') {\n        var table_obj = docxTable.getTable(objs_list[i].data, objs_list[i].options);\n        var table_xml = xmlBuilder.create(table_obj, {\n          version: '1.0',\n          encoding: 'UTF-8',\n          standalone: true\n        }).toString({\n          pretty: true,\n          indent: '  ',\n          newline: '\\n'\n        });\n        outString += table_xml;\n        continue;\n      }\n\n      outString += '<w:p w:rsidR=\"00A77427\" w:rsidRDefault=\"007F1D13\">';\n      var pPrData = '';\n\n      if (objs_list[i].options) {\n        if (objs_list[i].options.indentLeft) {\n          pPrData += '<w:ind w:left=\"' + objs_list[i].options.indentLeft + '\"/>';\n        }\n\n        if (objs_list[i].options.align) {\n          switch (objs_list[i].options.align) {\n            case 'center':\n              pPrData += '<w:jc w:val=\"center\"/>';\n              break;\n\n            case 'right':\n              pPrData += '<w:jc w:val=\"right\"/>';\n              break;\n\n            case 'justify':\n              pPrData += '<w:jc w:val=\"both\"/>';\n              break;\n          } // End of switch.\n\n        } // Endif.\n\n\n        if (objs_list[i].options.list_type) {\n          pPrData += '<w:pStyle w:val=\"ListParagraph\"/><w:numPr><w:ilvl w:val=\"0\"/><w:numId w:val=\"' + objs_list[i].options.list_type + '\"/></w:numPr>';\n        } // Endif.\n\n\n        if (objs_list[i].options.backline) {\n          pPrData += '<w:pPr><w:shd w:val=\"solid\" w:color=\"' + objs_list[i].options.backline + '\" w:fill=\"auto\"/></w:pPr>';\n        } // Endif.\n\n\n        if (objs_list[i].options.rtl) {\n          pPrData += '<w:bidi w:val=\"1\"/>';\n        } // Endif.\n\n      } // Endif.\n      // Some resource types have default style in case that there's no style settings:\n\n\n      var pStyleDef = objs_list[i].options && objs_list[i].options.pStyleDef || data.pStyleDef;\n\n      if (!pPrData && pStyleDef) {\n        pPrData = '<w:pStyle w:val=\"' + pStyleDef + '\"/>';\n      } // Endif.\n\n\n      if (pPrData) {\n        outString += '<w:pPr>' + pPrData + '</w:pPr>';\n      } // Endif.\n      // Work on all the objects in the document:\n\n\n      for (var j = 0, total_size_j = objs_list[i].data.length; j < total_size_j; j++) {\n        if (objs_list[i].data[j]) {\n          var rExtra = '';\n          var tExtra = '';\n          var rPrData = '';\n          var colorCode;\n          var valType;\n          var sizeVal;\n          var hyperlinkOn = false;\n\n          if (objs_list[i].data[j].options) {\n            if (objs_list[i].data[j].options.color) {\n              rPrData += '<w:color w:val=\"' + objs_list[i].data[j].options.color + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.back) {\n              colorCode = objs_list[i].data[j].options.shdColor || 'auto';\n              valType = objs_list[i].data[j].options.shdType || 'clear';\n              rPrData += '<w:shd w:val=\"' + valType + '\" w:color=\"' + colorCode + '\" w:fill=\"' + objs_list[i].data[j].options.back + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.highlight) {\n              valType = 'yellow';\n\n              if (typeof objs_list[i].data[j].options.highlight === 'string') {\n                valType = objs_list[i].data[j].options.highlight;\n              } // Endif.\n\n\n              rPrData += '<w:highlight w:val=\"' + valType + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.bold) {\n              rPrData += '<w:b/><w:bCs/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.italic) {\n              rPrData += '<w:i/><w:iCs/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.underline) {\n              valType = 'single';\n\n              if (typeof objs_list[i].data[j].options.underline === 'string') {\n                valType = objs_list[i].data[j].options.underline;\n              } // Endif.\n\n\n              rPrData += '<w:u w:val=\"' + valType + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.strikethrough) {\n              rPrData += '<w:strike/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.font_face) {\n              rPrData += '<w:rFonts w:ascii=\"' + objs_list[i].data[j].options.font_face + '\" w:eastAsia=\"' + objs_list[i].data[j].options.font_face + '\" w:hAnsi=\"' + objs_list[i].data[j].options.font_face + '\" w:cs=\"' + objs_list[i].data[j].options.font_face + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.font_size) {\n              var fontSizeInHalfPoints = 2 * objs_list[i].data[j].options.font_size;\n              rPrData += '<w:sz w:val=\"' + fontSizeInHalfPoints + '\"/><w:szCs w:val=\"' + fontSizeInHalfPoints + '\"/>';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.border) {\n              colorCode = 'auto';\n              valType = 'single';\n              sizeVal = 4;\n\n              if (typeof objs_list[i].data[j].options.borderColor === 'string') {\n                colorCode = objs_list[i].data[j].options.borderColor;\n              } // Endif.\n\n\n              if (typeof objs_list[i].data[j].options.border === 'string') {\n                valType = objs_list[i].data[j].options.border;\n              } // Endif.\n\n\n              if (typeof objs_list[i].data[j].options.borderSize === 'number' && objs_list[i].data[j].options.borderSize && objs_list[i].data[j].options.borderSize === objs_list[i].data[j].options.borderSize) {\n                sizeVal = objs_list[i].data[j].options.borderSize;\n              } // Endif.\n\n\n              rPrData += '<w:bdr w:val=\"' + valType + '\" w:sz=\"' + sizeVal + '\" w:space=\"0\" w:color=\"' + colorCode + '\"/>';\n            } // Endif.\n            // Hyperlink support:\n\n\n            if (objs_list[i].data[j].options.hyperlink) {\n              outString += '<w:hyperlink w:anchor=\"' + objs_list[i].data[j].options.hyperlink + '\">';\n              hyperlinkOn = true;\n\n              if (!rPrData) {\n                rPrData = '<w:rStyle w:val=\"Hyperlink\"/>';\n              } // Endif.\n\n            } // Endif.\n\n\n            if (objs_list[i].data[j].options.rtl) {\n              rPrData += '<w:rtl w:val=\"1\"/>';\n            } // Endif.\n\n          } // Endif.\n          // Field support:\n\n\n          if (objs_list[i].data[j].fieldObj) {\n            outString += '<w:fldSimple w:instr=\"' + objs_list[i].data[j].fieldObj + '\">';\n          } // Endif.\n\n\n          if (objs_list[i].data[j].text) {\n            if (objs_list[i].data[j].text[0] == ' ' || objs_list[i].data[j].text[objs_list[i].data[j].text.length - 1] == ' ') {\n              tExtra += ' xml:space=\"preserve\"';\n            } // Endif.\n\n\n            if (objs_list[i].data[j].link_rel_id) {\n              outString += '<w:hyperlink r:id=\"rId' + objs_list[i].data[j].link_rel_id + '\">';\n            }\n\n            outString += '<w:r' + rExtra + '>';\n\n            if (rPrData) {\n              outString += '<w:rPr>' + rPrData + '</w:rPr>';\n            } // Endif.\n\n\n            outString += '<w:t' + tExtra + '>' + objs_list[i].data[j].text.encodeHTML() + '</w:t></w:r>';\n\n            if (objs_list[i].data[j].link_rel_id) {\n              outString += '</w:hyperlink>';\n            }\n          } else if (objs_list[i].data[j].page_break) {\n            outString += '<w:r><w:br w:type=\"page\"/></w:r>';\n          } else if (objs_list[i].data[j].line_break) {\n            outString += '<w:r><w:br/></w:r>';\n          } else if (objs_list[i].data[j].horizontal_line) {\n            outString += '<w:r><w:pict><v:rect style=\"width:0;height:.75pt\" o:hralign=\"center\" o:hrstd=\"t\" o:hr=\"t\" fillcolor=\"#e0e0e0\" stroked=\"f\"/></w:pict></w:r>'; // Bookmark start support:\n          } else if (objs_list[i].data[j].bookmark_start) {\n            outString += '<w:bookmarkStart w:id=\"' + bookmarkId + '\" w:name=\"' + objs_list[i].data[j].bookmark_start + '\"/>'; // Bookmark end support:\n          } else if (objs_list[i].data[j].bookmark_end) {\n            outString += '<w:bookmarkEnd w:id=\"' + bookmarkId + '\"/>';\n            bookmarkId++;\n          } else if (objs_list[i].data[j].image) {\n            outString += '<w:r' + rExtra + '>';\n            rPrData += '<w:noProof/>';\n\n            if (rPrData) {\n              outString += '<w:rPr>' + rPrData + '</w:rPr>';\n            } // Endif.\n            //914400L / 96DPI\n\n\n            var pixelToEmu = 9525;\n            outString += '<w:drawing>';\n            outString += '<wp:inline distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\">';\n            outString += '<wp:extent cx=\"' + Math.round(objs_list[i].data[j].options.cx * pixelToEmu) + '\" cy=\"' + Math.round(objs_list[i].data[j].options.cy * pixelToEmu) + '\"/>';\n            outString += '<wp:effectExtent l=\"19050\" t=\"0\" r=\"9525\" b=\"0\"/>';\n            outString += '<wp:docPr id=\"' + (objs_list[i].data[j].image_id + 1) + '\" name=\"Picture ' + objs_list[i].data[j].image_id + '\" descr=\"Picture ' + objs_list[i].data[j].image_id + '\">';\n\n            if (objs_list[i].data[j].link_rel_id) {\n              outString += '<a:hlinkClick xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" r:id=\"rId' + objs_list[i].data[j].link_rel_id + '\"/>';\n            }\n\n            outString += '</wp:docPr>';\n            outString += '<wp:cNvGraphicFramePr>';\n            outString += '<a:graphicFrameLocks xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" noChangeAspect=\"1\"/>';\n            outString += '</wp:cNvGraphicFramePr>';\n            outString += '<a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">';\n            outString += '<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">';\n            outString += '<pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">';\n            outString += '<pic:nvPicPr>';\n            outString += '<pic:cNvPr id=\"0\" name=\"Picture ' + objs_list[i].data[j].image_id + '\"/>';\n            outString += '<pic:cNvPicPr/>';\n            outString += '</pic:nvPicPr>';\n            outString += '<pic:blipFill>';\n            outString += '<a:blip r:embed=\"rId' + objs_list[i].data[j].rel_id + '\" cstate=\"print\"/>';\n            outString += '<a:stretch>';\n            outString += '<a:fillRect/>';\n            outString += '</a:stretch>';\n            outString += '</pic:blipFill>';\n            outString += '<pic:spPr>';\n            outString += '<a:xfrm>';\n            outString += '<a:off x=\"0\" y=\"0\"/>';\n            outString += '<a:ext cx=\"' + objs_list[i].data[j].options.cx * pixelToEmu + '\" cy=\"' + objs_list[i].data[j].options.cy * pixelToEmu + '\"/>';\n            outString += '</a:xfrm>';\n            outString += '<a:prstGeom prst=\"rect\">';\n            outString += '<a:avLst/>';\n            outString += '</a:prstGeom>';\n            outString += '</pic:spPr>';\n            outString += '</pic:pic>';\n            outString += '</a:graphicData>';\n            outString += '</a:graphic>';\n            outString += '</wp:inline>';\n            outString += '</w:drawing>';\n            outString += '</w:r>';\n          } // Endif.\n          // Field support:\n\n\n          if (objs_list[i].data[j].fieldObj) {\n            outString += '</w:fldSimple>';\n          } // Endif.\n\n\n          if (hyperlinkOn) {\n            outString += '</w:hyperlink>';\n          } // Endif.\n\n        } // Endif.\n\n      } // Endif.\n\n\n      outString += '</w:p>';\n    } // End of for loop.\n\n\n    if (data.docType === 'document') {\n      outString += '<w:p w:rsidR=\"00A02F19\" w:rsidRDefault=\"00A02F19\"/>'; // Landscape orientation support:\n\n      if (options.orientation && options.orientation === 'landscape') {\n        var margins = options.pageMargins || {\n          top: 1800,\n          right: 1440,\n          bottom: 1800,\n          left: 1440\n        };\n        outString += '<w:sectPr w:rsidR=\"00A02F19\" w:rsidSect=\"00897086\">' + (docxData.secPrExtra ? docxData.secPrExtra : '') + '<w:pgSz w:w=\"15840\" w:h=\"12240\" w:orient=\"landscape\"/>' + '<w:pgMar w:top=\"' + margins.top + '\" w:right=\"' + margins.right + '\" w:bottom=\"' + margins.bottom + '\" w:left=\"' + margins.left + '\" w:header=\"720\" w:footer=\"720\" w:gutter=\"0\"/>' + '<w:cols w:space=\"720\"/>' + '<w:docGrid w:linePitch=\"360\"/>' + '</w:sectPr>';\n      } else {\n        var margins = options.pageMargins || {\n          top: 1440,\n          right: 1800,\n          bottom: 1440,\n          left: 1800\n        };\n        outString += '<w:sectPr w:rsidR=\"00A02F19\" w:rsidSect=\"00A02F19\">' + (docxData.secPrExtra ? docxData.secPrExtra : '') + '<w:pgSz w:w=\"12240\" w:h=\"15840\"/>' + '<w:pgMar w:top=\"' + margins.top + '\" w:right=\"' + margins.right + '\" w:bottom=\"' + margins.bottom + '\" w:left=\"' + margins.left + '\" w:header=\"720\" w:footer=\"720\" w:gutter=\"0\"/>' + '<w:cols w:space=\"720\"/>' + '<w:docGrid w:linePitch=\"360\"/>' + '</w:sectPr>';\n      } // Endif.\n\n    } // Endif.\n\n\n    outString += data.docEndExtra + '</w:' + data.docType + '>';\n    return outString;\n  } // Save it so if some plugin need to generate document style resource then it can use it:\n\n\n  genobj.cbMakeDocxDocument = cbMakeDocxDocument; // Prepare genobj for MS-Office:\n\n  msdoc.makemsdoc(genobj, new_type, options, gen_private, type_info);\n  gen_private.plugs.type.msoffice.makeOfficeGenerator('word', 'document', {});\n  genobj.on('clearData', function () {\n    genobj.data.length = 0;\n  });\n  genobj.on('beforeGen', cbPrepareDocxToGenerate); // Add the document's properties:\n\n  gen_private.plugs.type.msoffice.addInfoType('dc:title', '', 'title', 'setDocTitle');\n  gen_private.plugs.type.msoffice.addInfoType('dc:subject', '', 'subject', 'setDocSubject');\n  gen_private.plugs.type.msoffice.addInfoType('cp:keywords', '', 'keywords', 'setDocKeywords');\n  gen_private.plugs.type.msoffice.addInfoType('dc:description', '', 'description', 'setDescription');\n  gen_private.plugs.type.msoffice.addInfoType('cp:category', '', 'category', 'setDocCategory');\n  gen_private.plugs.type.msoffice.addInfoType('cp:contentStatus', '', 'status', 'setDocStatus'); // Create the plugins manager:\n\n  var plugsmanObj = new docplugman(genobj, gen_private, 'docx', setDefaultDocValues); // We'll register now any officegen internal plugin that we want to always use for Word based documents:\n\n  plugsmanObj.plugsList.push(new plugHeadfoot(plugsmanObj)); // BMK_DOCX_PLUG:\n  // Dynamic loading of additional plugins requested by the user:\n\n  if (options.extraPlugs && typeof options.extraPlugs === 'object' && options.extraPlugs.forEach) {\n    options.extraPlugs.forEach(function (value) {\n      var newPlug;\n\n      if (value) {\n        if (typeof value === 'function') {\n          // You already loaded the plugin:\n          newPlug = value;\n        } else if (typeof value === 'string') {\n          // We need to load the plugin:\n          newPlug = require('./' + value);\n        } // Endif.\n\n      } // Endif.\n\n\n      plugsmanObj.plugsList.push(new newPlug(plugsmanObj));\n    });\n  } // Endif.\n  // Access to our data:\n\n\n  var docxData = plugsmanObj.getDataStorage();\n  gen_private.type.msoffice.files_list.push({\n    name: '/word/settings.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml',\n    clear: 'type'\n  }, {\n    name: '/word/fontTable.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml',\n    clear: 'type'\n  }, {\n    name: '/word/webSettings.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml',\n    clear: 'type'\n  }, {\n    name: '/word/styles.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml',\n    clear: 'type'\n  }, {\n    name: '/word/document.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml',\n    clear: 'type'\n  }, {\n    // NJC - 20161231 - added to support bullets\n    name: '/word/numbering.xml',\n    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml',\n    clear: 'type'\n  });\n  gen_private.type.msoffice.rels_app.push({\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\n    target: 'styles.xml',\n    clear: 'type'\n  }, {\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings',\n    target: 'settings.xml',\n    clear: 'type'\n  }, {\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings',\n    target: 'webSettings.xml',\n    clear: 'type'\n  }, {\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable',\n    target: 'fontTable.xml',\n    clear: 'type'\n  }, {\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n    target: 'theme/theme1.xml',\n    clear: 'type'\n  }, {\n    // NJC - 20161231 - added to support bullets\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering',\n    target: 'numbering.xml',\n    clear: 'type'\n  });\n  genobj.data = []; // All the data will be placed here.\n\n  gen_private.plugs.intAddAnyResourceToParse('docProps\\\\app.xml', 'buffer', null, cbMakeDocxApp, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\fontTable.xml', 'buffer', null, cbMakeDocxFontsTable, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\settings.xml', 'buffer', null, cbMakeDocxSettings, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\webSettings.xml', 'buffer', null, cbMakeDocxWeb, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\styles.xml', 'buffer', {\n    styleXML: options.styleXML\n  }, cbMakeDocxStyles, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\document.xml', 'buffer', {\n    docType: 'document',\n    docStartExtra: '<w:body>',\n    docEndExtra: '</w:body>',\n    data: genobj.data\n  }, cbMakeDocxDocument, true);\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\numbering.xml', 'buffer', null, cbMakeDocxNumbers, true); // added to support bullets\n\n  gen_private.plugs.intAddAnyResourceToParse('word\\\\_rels\\\\document.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true); // ----- API for Word documents: -----\n\n  /**\n   * Create a new paragraph.\n   *\n   * @param {string} options Default options for all the objects inside this paragraph.\n   */\n\n  genobj.createP = function (options) {\n    // Create a new instance of the paragraph object:\n    return new docxP(genobj, gen_private, 'docx', genobj.data, {}, options);\n  };\n  /**\n   * ???.\n   *\n   * @param {object} options ???.\n   */\n\n\n  genobj.createListOfDots = function (options) {\n    var newP = genobj.createP(options);\n    newP.options.list_type = '1';\n    return newP;\n  };\n  /**\n   * Create a list of numbers based paragraph.\n   *\n   * @param {object} options ???.\n   */\n\n\n  genobj.createListOfNumbers = function (options) {\n    var newP = genobj.createP(options);\n    newP.options.list_type = '2';\n    return newP;\n  };\n  /**\n   * Add a page break.\n   * <br /><br />\n   *\n   * This method add a page break to the current Word document.\n   */\n\n\n  genobj.putPageBreak = function () {\n    var newP = {};\n    newP.data = [{\n      'page_break': true\n    }];\n    genobj.data[genobj.data.length] = newP;\n    return newP;\n  };\n  /**\n   * Add a page break.\n   * <br /><br />\n   *\n   * This method add a page break to the current Word document.\n   */\n\n\n  genobj.addPageBreak = function () {\n    var newP = {};\n    newP.data = [{\n      'page_break': true\n    }];\n    genobj.data[genobj.data.length] = newP;\n    return newP;\n  };\n  /**\n   * Create a table.\n   * <br /><br />\n   *\n   * This method add a table to the current word document.\n   *\n   * @param {object} data ???.\n   * @param {object} options ???.\n   */\n\n\n  genobj.createTable = function (data, options) {\n    var newP = genobj.createP(options);\n    newP.data = data;\n    newP.type = 'table';\n    return newP;\n  };\n  /**\n   * Create Json.\n   * <br /><br />\n   *\n   * @param {object} data ???.\n   * @param {object} newP ???.\n   */\n\n\n  genobj.createJson = function (data, newP) {\n    if (data.type !== 'table') {\n      newP = newP || genobj.createP(data.lopt || {});\n    }\n\n    switch (data.type) {\n      case \"text\":\n        newP.addText(data.val, data.opt);\n        break;\n\n      case \"linebreak\":\n        newP.addLineBreak();\n        break;\n\n      case \"horizontalline\":\n        newP.addHorizontalLine();\n        break;\n\n      case \"image\":\n        // Improved by peizhuang in Aug 2016 (added data.opt):\n        // data.imagetype been added by Ziv Barber in Aug 2016.\n        newP.addImage(data.path, data.opt || {}, data.imagetype);\n        break;\n\n      case \"pagebreak\":\n        newP = genobj.putPageBreak();\n        break;\n\n      case \"table\":\n        newP = genobj.createTable(data.val, data.opt);\n        break;\n\n      case \"numlist\":\n        newP = genobj.createListOfNumbers();\n        break;\n\n      case \"dotlist\":\n        newP = genobj.createListOfDots();\n        break;\n    }\n\n    return newP;\n  };\n  /**\n   * Create a document by json data.\n   * <br /><br />\n   *\n   * @param {array} dataArray ???.\n   */\n\n\n  genobj.createByJson = function (dataArray) {\n    var newP = {};\n    dataArray = [].concat(dataArray || []);\n    dataArray.forEach(function (data) {\n      if (Array.isArray(data)) {\n        newP = genobj.createP(data[0] || {});\n        data.forEach(function (d) {\n          newP = genobj.createJson(d, newP);\n        });\n      } else {\n        newP = genobj.createJson(data);\n      }\n    });\n    return newP;\n  }; // Tell all the features (plugins) to add extra API:\n\n\n  gen_private.features.type.docx.emitEvent('makeDocApi', genobj);\n  return this;\n}\n\nbaseobj.plugins.registerDocType('docx', makeDocx, {}, baseobj.docType.TEXT, \"Microsoft Word Document\");","map":null,"metadata":{},"sourceType":"script"}